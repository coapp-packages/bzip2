@import "version.inc";

#product-info
{
	product-name: "bzip2";
	version: "1.0.6";
	original-source-location: "http://www.bzip.org/1.0.6/bzip2-1.0.6.tar.gz";
	original-source-website: "http://www.bzip.org/";
	license: "BSD-style (custom, see LICENSE)";
	packager: "Philip Allison <mangobrain@googlemail.com>";
}

x86
{
	targets:
	{
		"bzip2.exe",
		"bzip2recover.exe",
		"libbz2.lib",
		"libbz2.dll"
	};

	build-command:
	@"
		nmake -f makefile.msc || goto failed
	";

	clean-command:
	@"
		nmake -f makefile.msc clean
	";
}

test
{
	uses: x86;
	/* Tests are run as part of nmake all in 'x86'. */
}

package
{
	uses: x86;

	targets:
	{
        @"COPKG\libbz2[vc10]-${package-version}-x86.msi",
        @"COPKG\libbz2-dev[vc10]-${package-version}-x86.msi",
        @"COPKG\libbz2-dev-common-${package-version}-any.msi",
        @"COPKG\bzip2-${package-version}-x86.msi",
	};

	build-command: @"
		cd COPKG
		autopackage libbz2.autopkg libbz2-dev-common.autopkg|| goto failed
        autopackage bzip2.autopkg libbz2-dev.autopkg || goto failed
	";

	clean-command: @"del COPKG\*.msi COPKG\*.wixpdb";
}
